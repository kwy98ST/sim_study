<?xml version='1.0' ?>
<launch>
    <arg name="namespace" default="" />
    <arg name="robot_name" default="$(var namespace)"/>
    <arg name="world_name" default="addinedu_map2.world"/>
    <arg name="world" default="$(find-pkg-share vicpinky_gazebo)/worlds/$(var world_name)"/>
    <arg name="bridge_params" default="$(find-pkg-share vicpinky_gazebo)/params/pinky_bridge.yaml"/>

    <arg name="x" default="0.0"/>
    <arg name="y" default="0.0"/> 
    <arg name="z" default="0.1"/>
    <arg name="R" default="0.0"/>
    <arg name="P" default="0.0"/>
    <arg name="Y" default="0.0"/>

    <set_env name="GZ_SIM_RESOURCE_PATH" value="$(find-pkg-share vicpinky_description)/../:/$(find-pkg-share vicpinky_gazebo)/models:/$(env HOME)/.gazebo/models"/>

    <include file="$(find-pkg-share ros_gz_sim)/launch/gz_sim.launch.py">
        <arg name='gz_args' value='-r -s -v4 $(var world)'/>
        <arg name='on_exit_shutdown' value='true'/>
    </include>

    <include file="$(find-pkg-share ros_gz_sim)/launch/gz_sim.launch.py">
        <arg name='gz_args' value='-g -v4'/>
    </include>

    <!-- Robot 1 -->
    <group>
        <arg name="namespace" default="$(var namespace)"/>

        <push-ros-namespace namespace="$(var namespace)"/>
        <include file="$(find-pkg-share vicpinky_description)/launch/upload.launch.xml">
            <arg name='use_sim_time' value='True'/>
            <arg name='namespace' value='$(var namespace)'/>
        </include>
        <node pkg="ros_gz_sim" exec="create" name='create' output='screen' args="-name $(var namespace) -topic robot_description -x $(var x) -y $(var y) -z $(var z)">
            <param name='use_sim_time' value='True'/>
        </node>
        <node pkg="ros_gz_bridge" exec="parameter_bridge" name='parameter_bridge' output='screen' args="--ros-args -p config_file:=$(var bridge_params) -name $(var namespace)"/>
        <node pkg="ros_gz_image" exec="image_bridge" name='image_bridge_raw' output='screen' args="camera/image_raw"/>
        <node pkg="ros_gz_image" exec="image_bridge" name='image_bridge_camera' output='screen' args="camera"/>

        <include file="$(find-pkg-share vicpinky_navigation)/launch/bringup_launch.xml">
            <arg name="namespace" value="$(var namespace)"/>
            <arg name="use_sim_time" value="True"/>
            <arg name="map" value="$(find-pkg-share vicpinky_navigation)/map/dobbymap2.yaml"/>
            <arg name="params_file" value="$(find-pkg-share vicpinky_navigation)/params/nav2_params_$(var namespace).yaml"/>
        </include>
    </group>

    

</launch>